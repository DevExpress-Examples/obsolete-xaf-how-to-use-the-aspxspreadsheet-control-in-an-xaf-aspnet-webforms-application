<!-- default file list -->
*Files to look at*:

* **[SpreadsheetEditor.cs](./CS/SpreadsheetExample.Module.Web/Editors/SpreadsheetEditor.cs) (VB: [SpreadsheetEditor.vb](./VB/SpreadsheetExample.Module.Web/Editors/SpreadsheetEditor.vb))**
* [Report.cs](./CS/SpreadsheetExample.Module/BusinessObjects/Report.cs) (VB: [Report.vb](./VB/SpreadsheetExample.Module/BusinessObjects/Report.vb))
* [SpreadsheetDocument.cs](./CS/SpreadsheetExample.Module/BusinessObjects/SpreadsheetDocument.cs) (VB: [SpreadsheetDocument.vb](./VB/SpreadsheetExample.Module/BusinessObjects/SpreadsheetDocument.vb))
<!-- default file list end -->
# T575086: How to use the ASPxSpreadsheet control in an XAF ASP.NET WebForms application


<strong>Scenario</strong><br>I want to display my business object that has a byte array property as an Excel document allowing users to modify the content and save it to the database. <a href="https://documentation.devexpress.com/AspNet/16157/ASP-NET-WebForms-Controls/Spreadsheet">ASPxSpreadsheet</a> is an appropriate component for this task, but how to implement a Web Property Editor based on it? <br><br><strong>Backgrounds</strong><br>Unlike regular ASP.NET editors and controls, ASPxSpreadsheet is a front-end to a document service similar to <a href="https://www.google.com/docs/about/">Google Docs</a> that will be running on your web site if you add this component to your application. Because of this, a property editor based on the ASPxSpreadsheet component has some specific features.<br><br>1. If a user opens a document, the next user who opens the same document will see the actual document content even if the first user did not save it to the database.<br><img src="https://raw.githubusercontent.com/DevExpress-Examples/t575086-how-to-use-the-aspxspreadsheet-control-in-an-xaf-aspnet-webforms-application-t575086/17.1.8+/media/632a1559-884e-4f5f-97b0-810170b66020.png"><br><br>2. The Refresh action does not discard changes made in the document. The actual document state is stored in the service, and the content stored in the database is used as backup.<br>3. The Save action updates the content stored in the database. If the user closed a document without clicking the Save action, changes made to the document will be stored on the service and another user can save them to the database.<br><br>The property editor demonstrated in this example works with properties of a specific type - SpreadsheetDocument, and does not write any changes to a property. Instead, it modifies referenced objects directly. The SpreadsheetExample.Module\BusinessObjects\Report.cs (SpreadsheetExample.Module\BusinessObjects\Report.vb) file contains a class that has a property of the SpreadsheetDocument type. Note that this property is considered a part of the persistent object (that is why it has the Aggregated attribute) and automatically initialized with the value within the AfterConstruction method.<br><br>The editor implementation is simple. Refer to the SpreadsheetExample\SpreadsheetExample.Module.Web\Editors\SpreadsheetEditor.cs (SpreadsheetExample\SpreadsheetExample.Module.Web\Editors\SpreadsheetEditor.vb) file for details. It uses the <a href="https://documentation.devexpress.com/AspNet/DevExpress.Web.ASPxSpreadsheet.ASPxSpreadsheet.Open.method(TF7IVQ)">ASPxSpreadsheet.Open</a> and <a href="https://documentation.devexpress.com/AspNet/DevExpress.Web.ASPxSpreadsheet.ASPxSpreadsheet.SaveCopy.method(nweV1w)">ASPxSpreadsheet.SaveCopy</a> methods to synchronize the opened document with the database. Documents are identified by the persistent object's key property. This allows opening a separate document for each record in the database.

<br/>


